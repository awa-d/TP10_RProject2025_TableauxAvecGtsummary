---
title: " "
author: ""
date: "24/03/2025"
output: html_document
---

# üìñ Chapitre II. Applications pratiques

## 0. Consigne

### Projet :
√âvaluation des politiques de transfert mon√©taire sur la pauvret√© et les in√©galit√©s au Burkina Faso, √† l‚Äôaide des donn√©es de l‚ÄôEHCVM 2021.

### Sc√©narios simul√©s :
- Sc√©nario 1 : Transfert universel ‚Äî Tous les m√©nages re√ßoivent une allocation annuelle de 100 000 CFA.
- Sc√©nario 2 : Transfert universel rural ‚Äî Seuls les m√©nages ruraux re√ßoivent l‚Äôallocation.
- Sc√©nario 3 : Chef de m√©nage femme ‚Äî Transfert cibl√© aux m√©nages dirig√©s par une femme.
- Sc√©nario 4 : Chef polygame ‚Äî Transfert aux m√©nages dont le chef est polygame.
- Sc√©nario 5 : Handicap ‚Äî Transfert aux m√©nages comprenant au moins un membre en situation de handicap.



## 1. Chargement et exploration des donn√©es EHCVM 2021

####  Objectif

Utiliser le package `gtsummary` pour explorer, r√©sumer et mieux comprendre les variables cl√©s.

#### Variables importantes

| Variable | Description |
|---------|-------------|
| `pcexp` | D√©pense par t√™te (proxy du revenu) |
| `hhsize` | Taille du m√©nage |
| `milieu` | Milieu de r√©sidence (`urbain` ou `rural`) |
| `hmstat` | Statut matrimonial du chef de m√©nage |
| `hgender` | Sexe du chef de m√©nage |
| `zref` | Seuil de pauvret√© national |
| `hhandig` | S'il y a des handicap√©s dans le m√©nage |

## 2. Chargement des donn√©es

#### Lecture du fichier

```{r, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE, results='hide'}
library(readr)

# Chargement du jeu de donn√©es EHCVM
dataset <- read_csv("data/ehcvm_welfare_2b_bfa2021.csv")
vars_interet <- c("hhid", "milieu", "pcexp","hmstat", "hhsize","hhandig", "hgender", "zref")
datasetapp <- dataset %>% 
  select(all_of(vars_interet))
```

## 3. Exploration pr√©liminaire
#### Aper√ßu des premi√®res lignes

```{r, echo=F, eval=TRUE, warning=FALSE, message=FALSE}
head(datasetapp)
str(datasetapp)
```

#### Dimensions de la base
```{r, echo=F, eval=TRUE, warning=FALSE, message=FALSE}
dim(datasetapp)
```


#### V√©rification de la qualit√© des donn√©es


```{r, echo=F, eval=TRUE, warning=FALSE, message=FALSE}
# Pourcentage de valeurs manquantes
missing_data <- colSums(is.na(datasetapp)) / nrow(datasetapp) * 100
# Filtre
missing_data <- missing_data[missing_data > 0]

# Affichage
if (length(missing_data) == 0) {
  cat("‚úÖ Il n'y a pas de valeurs manquantes dans le dataset.\n")
} else {
  cat("‚ùå Pourcentage de valeurs manquantes par variable :\n")
  print(missing_data)
}

```

```{r, echo=F, eval=TRUE, warning=FALSE, message=FALSE}
# Nombre de doublons
duplicate_count <- nrow(datasetapp[duplicated(datasetapp), ])
if (duplicate_count == 0) {
  cat("‚úÖ Il n'y a pas de doublons dans le dataset.\n")
} else {
  cat("‚ùå Il y a", duplicate_count, "doublon(s) dans le dataset.\n")
}
```


## 4. CORRECTION

√âvaluation des politiques de transfert mon√©taire sur la pauvret√© et les in√©galit√©s au Burkina Faso

### Introduction

Les programmes de transfert mon√©taire constituent une approche de protection sociale de pour lutter contre la pauvret√©.

### M√©thodologie

#### 1. Pr√©paration des donn√©es

Commen√ßons par charger les biblioth√®ques n√©cessaires et les donn√©es de l'EHCVM 2021.

```{r,echo=FALSE}
# Installer les packages si n√©cessaire
required_packages <- c("readr", "dplyr", "ggplot2", "gtsummary", "patchwork", "ineq", "kableExtra")

# V√©rifier si chaque package est install√©, sinon l'installer
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)

# Charger les biblioth√®ques
library(readr)
library(dplyr)
library(ggplot2)
library(gtsummary)
library(patchwork)
library(ineq)     # Pour le calcul du coefficient de Gini
library(kableExtra)
```

#### 2. Exploration des donn√©es Avec gtsummary

Avant de proc√©der aux simulations, examinons les caract√©ristiques de notre jeu de donn√©es.

ON VA METTRE DES TABLEAUX POUR CHAQUE VARIABLE. APRES ON VA CONCATENER LES TABLEAUX AVEC tbl_stack

```{r,echo=FALSE}
# R√©sum√© des statistiques descriptives
summary_stats <- datasetapp %>%
  tbl_summary(
    include = c(pcexp, hhsize, hmstat, hgender, milieu, hhandig),
    label = list(
      pcexp ~ "D√©penses par t√™te (FCFA)",
      hhsize ~ "Taille du m√©nage",
      hmstat ~ "Statut matrimonial du chef",
      hgender ~ "Genre du chef",
      milieu ~ "Milieu de r√©sidence",
      hhandig ~ "Pr√©sence de handicap√©s"
    ),
    statistic = list(
      all_continuous() ~ "{mean} ({max},{min},{sd})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = all_continuous() ~ 2,
    missing = "ifany"
  ) %>%
  modify_caption("Tableau 1. Caract√©ristiques des m√©nages burkinab√® (EHCVM 2021)")

summary_stats
```

#### 3. R√©sultats des simulations

```{r,echo=FALSE,eval=T}
# D√©finition du seuil de pauvret√© (zref)
# Cr√©ation de variables pour l'analyse de la pauvret√©
data_baseline <- datasetapp %>%
  mutate(
    pauvre = pcexp < zref,
    gap = ifelse(pauvre, zref - pcexp, 0),
    gap_normalise = gap / zref,
    gap_normalise_carre = gap_normalise^2
  )

# Calcul des indices FGT initiaux
fgt0_initial <- sum(data_baseline$pauvre * data_baseline$hhsize) / sum(data_baseline$hhsize)
fgt1_initial <- sum(data_baseline$gap_normalise * data_baseline$hhsize) / sum(data_baseline$hhsize)
fgt2_initial <- sum(data_baseline$gap_normalise_carre * data_baseline$hhsize) / sum(data_baseline$hhsize)

# Calcul du coefficient de Gini initial
gini_initial <- ineq(data_baseline$pcexp, type = "Gini")

# Affichage des indices initiaux
indices_initiaux <- data.frame(
  Indicateur = c("Incidence (FGT0)initial", "Profondeur (FGT1)initial", "S√©v√©rit√© (FGT2)initial", "Giniinitial"),
  Valeur = c(fgt0_initial, fgt1_initial, fgt2_initial, gini_initial)
)

```


```{r,echo=FALSE,eval=T}
### 4. Simulation des sc√©narios de transfert mon√©taire
# Montant du transfert par m√©nage (annuel)
montant_transfert <- 100000

# Fonction pour simuler un transfert et calculer les indices
simuler_transfert <- function(dataset, condition, nom_scenario) {
  
  data_sim <- dataset %>%
    mutate(
      beneficiaire = condition,
      transfert = ifelse(beneficiaire, montant_transfert / hhsize, 0),
      pcexp_new = pcexp + transfert,
      pauvre_new = pcexp_new < zref,
      gap_new = ifelse(pauvre_new, zref - pcexp_new, 0),
      gap_normalise_new = gap_new / zref,
      gap_normalise_carre_new = gap_normalise_new^2
    )
  
  # Calcul des indices FGT post-transfert
  fgt0_new <- sum(data_sim$pauvre_new * data_sim$hhsize) / sum(data_sim$hhsize)
  fgt1_new <- sum(data_sim$gap_normalise_new * data_sim$hhsize) / sum(data_sim$hhsize)
  fgt2_new <- sum(data_sim$gap_normalise_carre_new * data_sim$hhsize) / sum(data_sim$hhsize)
  
  # Coefficient de Gini post-transfert
  gini_new <- ineq(data_sim$pcexp_new, type = "Gini")
  
  # Co√ªt total du programme
  cout_total <- sum(data_sim$transfert * data_sim$hhsize)
  
  # R√©duction du gap de pauvret√©
  efficacite <- sum((dataset$gap - data_sim$gap_new) * data_sim$hhsize) / cout_total
  
  return(list(
    scenario = nom_scenario,
    fgt0 = fgt0_new,
    fgt1 = fgt1_new,
    fgt2 = fgt2_new,
    gini = gini_new,
    cout = cout_total,
    efficacite = efficacite,
    data = data_sim
  ))
}

# Lancement des diff√©rents sc√©narios
scenario1 <- simuler_transfert(data_baseline, TRUE, "Universel")
scenario2 <- simuler_transfert(data_baseline, data_baseline$milieu == "Rural", "Rural")
scenario3 <- simuler_transfert(data_baseline, data_baseline$hgender == "F√©minin", "Femme chef")
scenario4 <- simuler_transfert(data_baseline, data_baseline$hmstat == "Mari√©(e) polygame", "Polygames")
scenario5 <- simuler_transfert(data_baseline, data_baseline$hhandig == "Oui", "Handicap")
```

#### 4. Comparaison des diff√©rents sc√©narios
```{r,echo=FALSE,eval=T}
# Compilation des r√©sultats
resultats_scenarios <- bind_rows(
  data.frame(Scenario = scenario1$scenario, FGT0 = scenario1$fgt0, FGT1 = scenario1$fgt1, FGT2 = scenario1$fgt2, Gini = scenario1$gini, Cout = scenario1$cout, Efficacite = scenario1$efficacite),
  data.frame(Scenario = scenario2$scenario, FGT0 = scenario2$fgt0, FGT1 = scenario2$fgt1, FGT2 = scenario2$fgt2, Gini = scenario2$gini, Cout = scenario2$cout, Efficacite = scenario2$efficacite),
  data.frame(Scenario = scenario3$scenario, FGT0 = scenario3$fgt0, FGT1 = scenario3$fgt1, FGT2 = scenario3$fgt2, Gini = scenario3$gini, Cout = scenario3$cout, Efficacite = scenario3$efficacite),
  data.frame(Scenario = scenario4$scenario, FGT0 = scenario4$fgt0, FGT1 = scenario4$fgt1, FGT2 = scenario4$fgt2, Gini = scenario4$gini, Cout = scenario4$cout, Efficacite = scenario4$efficacite),
  data.frame(Scenario = scenario5$scenario, FGT0 = scenario5$fgt0, FGT1 = scenario5$fgt1, FGT2 = scenario5$fgt2, Gini = scenario5$gini, Cout = scenario5$cout, Efficacite = scenario5$efficacite)
)

# Ajout des valeurs de r√©f√©rence (baseline) pour comparaison
indices_reference <- data.frame(
  Scenario = "Sc√©nario 0 : sans transfert",
  FGT0 = fgt0_initial,
  FGT1 = fgt1_initial,
  FGT2 = fgt2_initial,
  Gini = gini_initial,
  Cout = 0,
  Efficacite = NA
)

resultats_complets <- bind_rows(indices_reference, resultats_scenarios)

# Affichage sous forme de tableau
print(resultats_complets)

ggplot(resultats_long, aes(x = Scenario, y = Valeur, fill = Scenario)) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ Indicateur, scales = "free_y") +
  labs(title = "Comparaison des sc√©narios pour chaque indicateur",
       x = "Sc√©nario de transfert", y = "Valeur de l'indicateur") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

#### Conclusion

Le ciblage universel est le plus efficace en termes d‚Äôimpact brut avec une forte r√©duction de la pauvret√© FGT0 : 0.354 (vs 0.390), FGT1 : 0.099, FGT2 : 0.038, Gini : 0.395,mais cela se fait au prix du co√ªt le plus √©lev√© : 717 600 000 FCFA, pour une efficacit√© mod√©r√©e (27.95 %).

Le ciblage polygame est le plus efficient (Efficacit√© : 42.96 %, co√ªt : 157 200 000 FCFA),
avec une r√©duction notable des indices  (FGT1 : 0.110 vs 0.116, FGT2 : 0.044).

Le ciblage rural constitue une strat√©gie √©quilibr√©e avec un impact significatif (FGT1 : 0.103), un co√ªt raisonnable : 383 800 000 FCFA et bonne efficacit√© : 39.29 %.

Des sc√©narios combin√©s comme rural + femme chef ou polygame + pr√©sence d'handicap√©s pourraient permettre une r√©duction significative de la pauvret√© √† moindre co√ªt, tout en assurant une meilleure ciblage des plus vuln√©rables.


### Annexe : D√©finitions et formules

Indices FGT (Foster-Greer-Thorbecke) :

- FGT0 (Incidence) : Proportion de la population vivant sous le seuil de pauvret√©

$$FGT_0 = \frac{1}{N} \sum_{i=1}^{N} \mathbf{1}(pcexp_i < z)$$
- FGT1 (Profondeur) : √âcart moyen normalis√© entre le revenu des pauvres et le seuil de pauvret√©

$$FGT_1 = \frac{1}{N} \sum_{i=1}^{N} \left( \frac{z - pcexp_i}{z} \right) \mathbf{1}(pcexp_i < z)$$

- FGT2 (S√©v√©rit√©) : Moyenne des carr√©s des √©carts normalis√©s, donnant plus de poids aux plus pauvres

$$FGT_2 = \frac{1}{N} \sum_{i=1}^{N} \left( \frac{z - pcexp_i}{z} \right)^2 \mathbf{1}(pcexp_i < z)$$

Coefficient de Gini : Mesure de l'in√©galit√© de la distribution des revenus au sein d'une hhsizeulation (0 = √©galit√© parfaite, 1 = in√©galit√© maximale)

$$G = \frac{\sum_{i=1}^{N} \sum_{j=1}^{N} |pcexp_i - pcexp_j|}{2 N^2 \bar{pcexp}}$$

o√π :  

- $N$ est la population totale,  

- $pcexp_i$ est la d√©pense de consommation par t√™te du m√©nage $\( i \)$,  

- $z$ est le seuil de pauvret√©,  

- $\mathbf{1}(pcexp_i < z)$ est une fonction indicatrice qui vaut 1 si $pcexp_i < z$, sinon 0,  

- $\bar{pcexp}$ est la moyenne des d√©penses de consommation par t√™te.

- Efficacit√© du transfert : Ratio entre la r√©duction du gap de pauvret√© et le co√ªt total du programme de transfert



<!-------------------------------FIN DE SCRIPT - Chapitre 2------------------------------------->